import{K as X,k as z,r as o,l as k,d as u,e as E,j as i,p as w,y as ee,u as H,a as f,F as ue,v as se,$ as te,M as ae,N as re,O as ne,C as ie,w as M,s as oe,B as p,f as _,G as ce,A as le,L as de}from"./index.3996ea3a.js";import{D as me}from"./DynamicModuleLoader.a88b5f4e.js";import{g as $,a as pe,b as _e,w as ve,f as F,d as j,c as ge,S as W}from"./Select.45b962fc.js";import{T as N,b as B,c as fe}from"./Text.d7c5cc0a.js";import{S}from"./Skeleton.6dbd9952.js";import{d as Ne}from"./dayjs.min.836cc9db.js";import{A as he}from"./AppImage.c08ece6e.js";import{u as Ee}from"./unreserveWishThunk.4364bddf.js";import{s as De}from"./setWishCompleted.dd161aee.js";import{a as K,S as Ce}from"./check.f8f3949b.js";import{S as be}from"./SeoHead.9f3e0582.js";import{W as xe}from"./WishListItem.51abdbd5.js";const Ae="_glass_uspv0_1",Le="_wrapper_uspv0_19",Be="_wishImg_uspv0_32",ye="_wrapperInfo_uspv0_72",Fe="_btnWrapper_uspv0_86",Se="_wrapperUser_uspv0_90",Ie="_top_uspv0_95",Re="_time_uspv0_119",We="_wishName_uspv0_149",Te="_description_uspv0_166",ke="_btn_uspv0_86",$e="_btnReserve_uspv0_204",Oe="_divReserve_uspv0_232",Ue="_reserverWrapper_uspv0_263",Ge="_userImg_uspv0_267",Me="_userText_uspv0_271",je="_skeletonImg_uspv0_287",ze="_bottomBtn_uspv0_291",He="_listName_uspv0_327",Ke="_completed_uspv0_355",Ye="_isReserved_uspv0_360",a={glass:Ae,wrapper:Le,wishImg:Be,wrapperInfo:ye,btnWrapper:Fe,wrapperUser:Se,top:Ie,time:Re,wishName:We,description:Te,btn:ke,btnReserve:$e,divReserve:Oe,reserverWrapper:Ue,userImg:Ge,userText:Me,skeletonImg:je,bottomBtn:ze,listName:He,completed:Ke,isReserved:Ye},Pe=X($,z,(n,r)=>!n||!r?!1:n.user_id===r.id),Ve="_GiftsFromList_hysf2_1",Ze="_text_hysf2_19",qe="_wrapper_hysf2_35",Je="_card_hysf2_47",v={GiftsFromList:Ve,text:Ze,wrapper:qe,card:Je},Qe="_GiftsFriendsListItem_1gy1n_2",Xe="_img_1gy1n_31",we="_text_1gy1n_54",e4="_description_1gy1n_65",u4="_name_1gy1n_69",s4="_user_1gy1n_106",t4="_bottom_1gy1n_119",a4="_btn_1gy1n_126",r4="_btnCancellation_1gy1n_130",x={GiftsFriendsListItem:Qe,img:Xe,text:we,description:e4,name:u4,user:s4,bottom:t4,btn:a4,btnCancellation:r4},n4=o.exports.memo(n=>{const{className:r,wish:s,onClick:t}=n;return k(),u("div",{className:E(x.GiftsFriendsListItem,{},[r]),children:u("div",{className:x.imgWrapper,onClick:t,children:i("div",{className:x.btn,children:[u(he,{fallback:u(S,{width:397,height:300}),src:s.img,className:x.img}),u("div",{className:x.text,children:u("div",{children:u(N,{title:s.name,className:x.name,size:B.S})})})]})})})}),i4=(n,r,s)=>{var l;if(!r)return[];const t=(l=n.listDetails)==null?void 0:l.data;return!t||!Array.isArray(t.wishes)?[]:t.wishes.filter(e=>e.id!==s)},L=w("lists/fetchListById",async(n,{extra:r,rejectWithValue:s})=>{try{const t=await r.api.get(`/lists/${n}`);if(!t.data)throw new Error;return t.data}catch{return s("\u041D\u0435 \u0443\u0434\u0430\u043B\u043E\u0441\u044C \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044C \u0441\u043F\u0438\u0441\u043E\u043A")}}),o4={isLoading:!1},c4=ee({name:"listDetails",initialState:o4,reducers:{},extraReducers:n=>{n.addCase(L.pending,r=>{r.isLoading=!0,r.error=void 0}).addCase(L.fulfilled,(r,s)=>{r.isLoading=!1,r.data=s.payload}).addCase(L.rejected,(r,s)=>{r.isLoading=!1,r.error=s.payload})}}),{reducer:l4}=c4;new Array(9).fill(0).map((n,r)=>"");const d4=o.exports.memo(n=>{const{className:r,isLoading:s}=n,t=k(),l=H(),e=f($),D=f(c=>{var d,C;return e!=null&&e.list_id?(C=(d=c.lists)==null?void 0:d.entities)==null?void 0:C[e.list_id]:void 0}),m=f(c=>i4(c,e==null?void 0:e.list_id,e==null?void 0:e.id));return o.exports.useEffect(()=>{(e==null?void 0:e.list_id)&&!D&&l(L(e.list_id))},[e==null?void 0:e.list_id,D,l]),m.length?u("div",{className:E(v.GiftsFromList,{},[r]),children:u("div",{className:v.background,children:s?i("div",{className:v.wrapper,children:[u(S,{width:260,height:285,className:v.card}),u(S,{width:260,height:285,className:v.card})]}):i(ue,{children:[u(N,{title:"\u0414\u0440\u0443\u0433\u0438\u0435 \u043F\u043E\u0434\u0430\u0440\u043A\u0438 \u0438\u0437 \u0441\u043F\u0438\u0441\u043A\u0430",size:B.S,className:v.text}),u("div",{className:v.wrapper,children:m.map(c=>u(n4,{className:v.card,wish:c,onClick:()=>{t(se(String(c.id)))}},c.id))})]})})}):null}),m4=async n=>te.post("/reservation/reserve",{wishId:n}),p4={wishDetails:ge,listDetails:l4},T4=o.exports.memo(n=>{var U,G;const{className:r,id:s}=n,t=H(),l=f(pe),e=f($),D=f(_e),m=f(Pe),c=f(z),d=k();o.exports.useEffect(()=>{s&&(t(ve.clear()),t(F(s)))},[s,t]),ae(()=>{t(F(s))}),o.exports.useEffect(()=>{e!=null&&e.list_id&&t(L(e.list_id))},[e==null?void 0:e.list_id,t]);const C=o.exports.useCallback(()=>{s!==void 0&&d(re(s))},[e==null?void 0:e.id,s,d]),I=o.exports.useCallback(()=>{if(!s)return;window.confirm("\u0412\u044B \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0442\u0435\u043B\u044C\u043D\u043E \u0445\u043E\u0442\u0438\u0442\u0435 \u0443\u0434\u0430\u043B\u0438\u0442\u044C \u043F\u043E\u0434\u0430\u0440\u043E\u043A?")&&t(j(s)).then(Q=>{j.fulfilled.match(Q)?(console.log("\u0423\u0434\u0430\u043B\u0435\u043D\u043E!"),d(ne()),c&&t(ie({idUser:c.id}))):console.error("\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u0440\u0438 \u0443\u0434\u0430\u043B\u0435\u043D\u0438\u0438")})},[e==null?void 0:e.id,s,d]);let b;const R=async()=>{try{await m4(Number(s)),t(F(s))}catch(y){console.error("\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u0440\u0438 \u0440\u0435\u0437\u0435\u0440\u0432\u0438\u0440\u043E\u0432\u0430\u043D\u0438\u0438",y),alert("\u041D\u0435 \u0443\u0434\u0430\u043B\u043E\u0441\u044C \u0437\u0430\u0440\u0435\u0437\u0435\u0440\u0432\u0438\u0440\u043E\u0432\u0430\u0442\u044C \u043F\u043E\u0434\u0430\u0440\u043E\u043A")}},h=async()=>{try{await t(Ee(Number(s))).unwrap(),t(F(s))}catch(y){console.error("\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u0440\u0438 \u0441\u043D\u044F\u0442\u0438\u0438 \u0440\u0435\u0437\u0435\u0440\u0432\u0430\u0446\u0438\u0438",y),alert("\u041D\u0435 \u0443\u0434\u0430\u043B\u043E\u0441\u044C \u043E\u0442\u043C\u0435\u043D\u0438\u0442\u044C \u0440\u0435\u0437\u0435\u0440\u0432")}},O=Boolean(e==null?void 0:e.reservation),Y=((U=e==null?void 0:e.reservation)==null?void 0:U.user_id)===(c==null?void 0:c.id),P=()=>{!e||t(De({id:e.id,completed:!e.completed}))};l?b=u(S,{width:890,height:500}):D?b=u(N,{align:fe.CENTER,title:"\u041F\u0440\u043E\u0438\u0437\u043E\u0448\u043B\u0430 \u043E\u0448\u0438\u0431\u043A\u0430 \u043F\u0440\u0438 \u0437\u0430\u0440\u0433\u0443\u0437\u043A\u0435 \u0436\u0435\u043B\u0430\u043D\u0438\u044F"}):b=i("div",{className:E(a.wrapper,{[a.completed]:e==null?void 0:e.completed,[a.isReserved]:O}),children:[u("img",{src:e==null?void 0:e.img,className:a.wishImg}),i("div",{className:a.wrapperInfo,children:[i("div",{className:a.part_one,children:[i("div",{className:a.top,children:[u(M,{to:oe(String(e==null?void 0:e.user_id)),children:i("div",{className:a.wrapperUser,children:[u("img",{src:e==null?void 0:e.user.img,className:a.userImg}),u(N,{text:e==null?void 0:e.user.name,className:a.userText})]})}),u(N,{className:a.time,text:Ne(e==null?void 0:e.createdAt).format(" HH:mm DD.MM.YYYY "),size:B.S})]}),u(N,{title:e==null?void 0:e.name,size:B.M,className:a.wishName}),u(N,{text:e==null?void 0:e.description,className:a.description})]}),u("div",{className:a.part_two,children:i("div",{className:a.btnWrapper,children:[e!=null&&e.url?u(p,{className:a.btn,theme:_.OUTLINE,children:u("a",{href:e==null?void 0:e.url,children:"\u0421\u0441\u044B\u043B\u043A\u0430"})}):"\xA0",u(p,{className:a.btn,theme:_.OUTLINE,children:u("a",{href:`https://www.ozon.ru/search/?text=${e==null?void 0:e.name}`,children:"\u041D\u0430\u0439\u0442\u0438 \u043D\u0430 OZON"})}),u(p,{className:a.btn,theme:_.OUTLINE,children:u("a",{href:`https://www.wildberries.ru/catalog/0/search.aspx?search=${e==null?void 0:e.name}`,children:"\u041D\u0430\u0439\u0442\u0438 \u043D\u0430 Wildberries"})}),O?Y?u(p,{className:a.btnReserve,onClick:h,theme:_.OUTLINE,children:"\u041E\u0442\u043C\u0435\u043D\u0438\u0442\u044C \u0440\u0435\u0437\u0435\u0440\u0432\u0430\u0446\u0438\u044E"}):u("div",{className:a.divReserve,children:"\u0417\u0430\u0440\u0435\u0437\u0435\u0440\u0432\u0438\u0440\u043E\u0432\u0430\u043D\u043E"}):m?"\xA0":i(p,{className:a.btnReserve,onClick:R,theme:_.BACKGROUND,children:["\u0417\u0430\u0440\u0435\u0437\u0435\u0440\u0432\u0438\u0440\u043E\u0432\u0430\u0442\u044C ",u(K,{})]}),u(M,{to:ce(String(e==null?void 0:e.list_id)),children:i("div",{className:a.listName,children:["\u0421\u043F\u0438\u0441\u043E\u043A: ",((G=e==null?void 0:e.list)==null?void 0:G.name)||"\u0411\u0435\u0437 \u043D\u0430\u0437\u0432\u0430\u043D\u0438\u044F"]})})]})})]})]});const V=`${e==null?void 0:e.name} \u2014 ${le}`,Z=(e==null?void 0:e.description)||"\u0421\u043C\u043E\u0442\u0440\u0438\u0442\u0435 \u043F\u043E\u0434\u0440\u043E\u0431\u043D\u043E\u0441\u0442\u0438 \u043F\u043E\u0434\u0430\u0440\u043A\u0430 \u0438 \u0432\u043E\u0437\u043C\u043E\u0436\u043D\u043E\u0441\u0442\u044C \u0435\u0433\u043E \u0437\u0430\u0440\u0435\u0437\u0435\u0440\u0432\u0438\u0440\u043E\u0432\u0430\u0442\u044C.",q=`https://vishi.ru/wish/${e==null?void 0:e.id}`,J=(e==null?void 0:e.img)||"/images/preview-wish.jpg";return i(me,{reducers:p4,removeAfterUnmount:!0,children:[u(be,{title:V,description:Z,url:q,image:J}),i("div",{className:E(a.WishDetails,{},[r]),children:[u("div",{className:a.glass,children:b}),m&&i("div",{className:a.bottomBtn,children:[u(p,{theme:_.BACKGROUND_INVERTED,className:a.editBtn,onClick:C,children:"\u0420\u0435\u0434\u0430\u043A\u0442\u0438\u0440\u043E\u0432\u0430\u0442\u044C"}),u(p,{theme:_.OUTLINE,className:a.editBtn,onClick:I,children:"\u0423\u0414\u0410\u041B\u0418\u0422\u042C"}),u(p,{onClick:P,theme:_.BACKGROUND,className:a.editBtn,children:e!=null&&e.completed?"\u0412\u0435\u0440\u043D\u0443\u0442\u044C \u0432 \u0430\u043A\u0442\u0438\u0432\u043D\u044B\u0435":"\u0418\u0441\u043F\u043E\u043B\u043D\u0435\u043D\u043E"})]}),u(d4,{isLoading:l})]})]})});var T=(n=>(n.TITLE="title",n.CREATED="createdAt",n))(T||{});const _4="_WishList_159tl_1",v4="_wrapper_159tl_15",g4="_notFound_159tl_19",f4="_wrap_159tl_15",N4="_pin_159tl_27",g={WishList:_4,wrapper:v4,notFound:g4,wrap:f4,pin:N4},k4=o.exports.memo(n=>{const{className:r,wishes:s,isLoading:t}=n,l=e=>i("div",{className:g.wrap,children:[u(xe,{wish:e,className:g.card},e.id),(e==null?void 0:e.completed)&&u("div",{className:g.pin,children:u(Ce,{})}),!(e!=null&&e.completed)&&(e==null?void 0:e.isReserved)&&u("div",{className:g.pin,children:u(K,{})})]});return!t&&!s.length?u("div",{className:E(g.WishList,{},[r]),children:u(N,{className:g.notFound,title:"\u041D\u0435 \u043D\u0430\u0439\u0434\u0435\u043D\u043E",size:B.M})}):u("div",{className:E(g.WishList,{},[r]),children:i("div",{className:g.wrapper,children:[s.length>0?s.map(l):null,t&&u(de,{})]})})}),h4="_WishSortSelector_185js_1",E4="_sortBy_185js_18",D4="_order_185js_23",A={WishSortSelector:h4,sortBy:E4,order:D4},$4=o.exports.memo(n=>{const{className:r,onChangeOrder:s,onChangeSort:t,order:l,sort:e,status:D,onChangeStatus:m}=n,c=o.exports.useMemo(()=>[{value:"asc",content:"\u0432\u043E\u0437\u0440\u0430\u0441\u0442\u0430\u043D\u0438\u044E"},{value:"desc",content:"\u0443\u0431\u044B\u0432\u0430\u043D\u0438\u044E"}],[]),d=o.exports.useMemo(()=>[{value:T.CREATED,content:"\u0434\u0430\u0442\u0435"},{value:T.TITLE,content:"\u043D\u0430\u0437\u0432\u0430\u043D\u0438\u044E"}],[]),C=o.exports.useMemo(()=>[{value:"active",content:"\u0430\u043A\u0442\u0438\u0432\u043D\u044B\u0435"},{value:"all",content:"\u0432\u0441\u0435"}],[]),I=o.exports.useCallback(h=>{t(h)},[t]),b=o.exports.useCallback(h=>{s(h)},[s]),R=o.exports.useCallback(h=>{m(h)},[m]);return i("div",{className:E(A.WishSortSelector,{},[r]),children:[u("div",{className:A.sortBy,children:"\u0421\u043E\u0440\u0442\u0438\u0440\u043E\u0432\u0430\u0442\u044C \u043F\u043E"}),u(W,{options:d,value:e,onChange:I,className:A.order}),u(W,{options:c,label:"",value:l,onChange:b,className:A.order}),u(W,{options:C,label:"",value:D,onChange:R,className:A.order})]})});export{T4 as W,T as a,$4 as b,k4 as c};
