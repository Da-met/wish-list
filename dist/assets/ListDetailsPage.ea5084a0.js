import{p as B,x as _,y as F,u as y,a as L,r as o,d as t,j as h,$ as N,o as W,A as p,P as w,e as S}from"./index.3996ea3a.js";import{W as x}from"./WishListItem.51abdbd5.js";import{s as D}from"./setWishCompleted.dd161aee.js";import{S as C,a as $}from"./check.f8f3949b.js";import{D as j}from"./DynamicModuleLoader.a88b5f4e.js";import{T as P}from"./Text.d7c5cc0a.js";import{S as I}from"./SeoHead.9f3e0582.js";import"./AppImage.c08ece6e.js";import"./Avatar.b85790fb.js";import"./Skeleton.6dbd9952.js";const T="_wrapper_tmpp4_1",R="_textWrapper_tmpp4_10",b="_wrappName_tmpp4_24",k="_name_tmpp4_39",n={wrapper:T,textWrapper:R,wrappName:b,name:k},m=B("wishesByList/fetchWishesByList",async({listId:e},u)=>{const{extra:s,rejectWithValue:a}=u;try{const i=await s.api.get(`/wish/by-list/${e}`);if(!i.data)throw new Error("\u041F\u043E\u0434\u0430\u0440\u043A\u0438 \u043D\u0435 \u043D\u0430\u0439\u0434\u0435\u043D\u044B");return i.data}catch{return a("\u041E\u0448\u0438\u0431\u043A\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043A\u0438 \u043F\u043E\u0434\u0430\u0440\u043A\u043E\u0432 \u0441\u043F\u0438\u0441\u043A\u0430")}}),M="_WishesByList_fjvaj_1",H="_wrap_fjvaj_20",O="_pin_fjvaj_25",l={WishesByList:M,wrap:H,pin:O},c=_({selectId:e=>e.id}),U=c.getInitialState({isLoading:!1,error:void 0}),V=F({name:"wishesByList",initialState:U,reducers:{toggleWishCompleted:(e,u)=>{const s=e.entities[u.payload.wishId];s&&(s.completed=u.payload.completed)}},extraReducers:e=>{e.addCase(m.pending,u=>{u.isLoading=!0,u.error=void 0}).addCase(m.fulfilled,(u,s)=>{u.isLoading=!1,c.setAll(u,s.payload)}).addCase(m.rejected,(u,s)=>{u.isLoading=!1,u.error=s.payload}).addCase(D.fulfilled,(u,s)=>{c.upsertOne(u,s.payload)})}}),{reducer:q}=V;c.getSelectors(e=>e.wishesByList);const z=e=>{var u;return(u=e.wishesByList)!=null?u:c.getInitialState()},G=c.getSelectors(z).selectAll,J=e=>{var u,s;return(s=(u=e.wishesByList)==null?void 0:u.isLoading)!=null?s:!1},K=e=>{var u,s;return(s=(u=e.wishesByList)==null?void 0:u.error)!=null?s:""},Q=({listId:e,className:u})=>{const s=y(),a=L(G),i=L(J),d=L(K);return o.exports.useEffect(()=>{e&&s(m({listId:e}))},[e,s]),i?t("div",{children:"\u0417\u0430\u0433\u0440\u0443\u0437\u043A\u0430 \u043F\u043E\u0434\u0430\u0440\u043A\u043E\u0432..."}):d?h("div",{children:["\u041E\u0448\u0438\u0431\u043A\u0430: ",d]}):a.length?t("div",{className:l.WishesByList,children:a.map(r=>h("div",{className:l.wrap,children:[t(x,{wish:r},r.id),(r==null?void 0:r.completed)&&t("div",{className:l.pin,children:t(C,{})}),!(r!=null&&r.completed)&&(r==null?void 0:r.isReserved)&&t("div",{className:l.pin,children:t($,{})})]}))}):t("div",{children:"\u041F\u043E\u0434\u0430\u0440\u043A\u043E\u0432 \u043F\u043E\u043A\u0430 \u043D\u0435\u0442"})},X=async e=>(await N.get(`/lists/${e}`)).data,Y={wishesByList:q},Z=e=>{const{className:u}=e,{id:s}=W();y();const[a,i]=o.exports.useState(null),[d,r]=o.exports.useState(!0),[g,E]=o.exports.useState(null);if(o.exports.useEffect(()=>{if(!s)return;(async()=>{try{const f=await X(Number(s));i(f)}catch(f){E("\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043A\u0435 \u0441\u043F\u0438\u0441\u043A\u0430"),console.error(f)}finally{r(!1)}})()},[s]),d)return t("div",{children:"\u0417\u0430\u0433\u0440\u0443\u0437\u043A\u0430..."});if(g)return t("div",{children:g});if(!a)return t("div",{children:"\u0421\u043F\u0438\u0441\u043E\u043A \u043D\u0435 \u043D\u0430\u0439\u0434\u0435\u043D"});const A=a?`${a.name} \u2014 ${p}`:`\u0421\u043F\u0438\u0441\u043E\u043A \u043F\u043E\u0434\u0430\u0440\u043A\u043E\u0432 \u2014 ${p}`,v=a?`\u0421\u043F\u0438\u0441\u043E\u043A \u043F\u043E\u0434\u0430\u0440\u043A\u043E\u0432 "${a.name}" \u0432 ${p}. \u041F\u0440\u043E\u0441\u043C\u0430\u0442\u0440\u0438\u0432\u0430\u0439\u0442\u0435 \u0438\u0434\u0435\u0438, \u0434\u0435\u043B\u0438\u0442\u0435\u0441\u044C \u0441 \u0434\u0440\u0443\u0437\u044C\u044F\u043C\u0438 \u0438 \u0431\u0440\u043E\u043D\u0438\u0440\u0443\u0439\u0442\u0435 \u043F\u043E\u0434\u0430\u0440\u043A\u0438.`:`\u0421\u043F\u0438\u0441\u043E\u043A \u043F\u043E\u0434\u0430\u0440\u043A\u043E\u0432 \u0432 ${p}.`;return h(j,{reducers:Y,removeAfterUnmount:!0,children:[t(I,{title:A,description:v,url:"https://giftflow.ru/",image:"https://giftflow.ru/images/preview-main.jpg"}),t(w,{className:S(n.ListDetailsPage,{},[u]),children:h("div",{className:n.wrapper,children:[t("div",{className:n.textWrapper,children:t(P,{title:"\u0421\u043F\u043E\u0441\u043E\u043A \u043F\u043E\u0434\u0430\u0440\u043A\u043E\u0432 \u0438\u0437 \u043B\u0438\u0441\u0442\u0430",className:n.title,titleTag:"h1"})}),t("div",{className:n.wrappName,children:t("h2",{className:n.name,children:a==null?void 0:a.name})}),t("div",{className:n.wrapperCards,children:t(Q,{listId:String(a==null?void 0:a.id)})})]})})]})},p4=o.exports.memo(Z);export{p4 as default};
