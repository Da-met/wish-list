import{p as F,y as X,r as p,a as d,k as Y,Q as Z,u as u4,l as s4,M as e4,z as t4,d as r,j as _,B as v,f as S,m as a4,e as r4,v as y,C as i4,o as o4,P as n4,A as L}from"./index.3996ea3a.js";import{T as j,c as c4}from"./Text.d7c5cc0a.js";import{a as l4,b as d4,S as p4,f as h4,g as m4,c as E4}from"./Select.45b962fc.js";import{D as T}from"./DynamicModuleLoader.a88b5f4e.js";import{S as g4}from"./Skeleton.6dbd9952.js";import{I as w}from"./Input.4d1603a8.js";import{I as _4}from"./InputImg.20d82472.js";import{S as f4}from"./SeoHead.9f3e0582.js";import"./setWishCompleted.dd161aee.js";const W4="_header_9dcjk_1",D4="_wrapper_9dcjk_6",U={header:W4,wrapper:D4},A4="_glass_xbun9_1",b4="_wrapper_xbun9_17",C4="_wishImg_xbun9_30",w4="_wrapperInfo_xbun9_72",F4="_part_one_xbun9_92",B4="_btnWrapper_xbun9_107",I4="_wrapperUser_xbun9_111",x4="_top_xbun9_116",N4="_wishName_xbun9_147",v4="_description_xbun9_161",S4="_btn_xbun9_107",y4="_btnAdd_xbun9_199",L4="_reserverWrapper_xbun9_203",U4="_time_xbun9_207",k4="_skeletonImg_xbun9_212",j4="_bottomBtn_xbun9_216",T4="_fields_xbun9_228",R4="_list_xbun9_250",i={glass:A4,wrapper:b4,wishImg:C4,wrapperInfo:w4,part_one:F4,btnWrapper:B4,wrapperUser:I4,top:x4,wishName:N4,description:v4,btn:S4,btnAdd:y4,reserverWrapper:L4,time:U4,skeletonImg:k4,bottomBtn:j4,fields:T4,list:R4},f=F("wish/addWish",async(s,u)=>{console.log(s);const{extra:a,rejectWithValue:o,getState:c}=u;try{return(await a.api.post("/wish",s)).data}catch{return o("\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u0440\u0438 \u0434\u043E\u0431\u0430\u0432\u043B\u0435\u043D\u0438\u0438 \u043F\u043E\u0434\u0430\u0440\u043A\u0430")}});F("wish/updateWish",async({id:s,...u},a)=>{const{extra:o,rejectWithValue:c}=a;try{return(await o.api.put(`/wish/${s}`,u)).data}catch{return c("\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u0440\u0438 \u043E\u0431\u043D\u043E\u0432\u043B\u0435\u043D\u0438\u0438 \u043F\u043E\u0434\u0430\u0440\u043A\u0430")}});const $4={isLoading:!1,error:void 0,name:"",description:"",img:"",url:"",list_id:void 0},R=X({name:"addWishForm",initialState:$4,reducers:{setWishName:(s,u)=>{s.name=u.payload},setWishDescription:(s,u)=>{s.description=u.payload},setWishImg:(s,u)=>{s.img=u.payload},setWishUrl:(s,u)=>{s.url=u.payload},setWishListId:(s,u)=>{s.list_id=u.payload}},extraReducers:s=>{s.addCase(f.pending,u=>{u.error=void 0,u.isLoading=!0}).addCase(f.fulfilled,(u,a)=>{u.isLoading=!1}).addCase(f.rejected,(u,a)=>{u.isLoading=!1,u.error=a.payload})}}),{actions:n}=R,{reducer:P4}=R,M4=s=>{var u;return(u=s.addWishForm)==null?void 0:u.name},O4=s=>{var u;return(u=s.addWishForm)==null?void 0:u.description},G4=s=>{var u;return(u=s.addWishForm)==null?void 0:u.img},Q4=s=>{var u;return(u=s.addWishForm)==null?void 0:u.url},V4=s=>{var u;return(u=s.addWishForm)==null?void 0:u.list_id},k=F("wish/updateWish",async({id:s,data:u},{extra:a,rejectWithValue:o})=>{try{return(await a.api.put(`/wish/${s}`,u)).data}catch(c){return console.error("\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u0440\u0438 \u043E\u0431\u043D\u043E\u0432\u043B\u0435\u043D\u0438\u0438 \u043F\u043E\u0434\u0430\u0440\u043A\u0430",c),o("\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u0440\u0438 \u043E\u0431\u043D\u043E\u0432\u043B\u0435\u043D\u0438\u0438 \u043F\u043E\u0434\u0430\u0440\u043A\u0430")}}),q4={addWishForm:P4},z4=p.exports.memo(s=>{const{className:u,id:a,isEdit:o}=s,c=d(Y),b=Z().state,B=b==null?void 0:b.listId,t=u4(),$=d(l4),P=d(d4);o==!0&&console.log("IS EDIT IS EDIT");const C=s4();e4(()=>{!o&&B&&t(n.setWishListId(Number(B))),o&&a&&t(h4(a)).then(e=>{if(e.meta.requestStatus==="fulfilled"&&typeof e.payload=="object"&&e.payload!==null){const l=e.payload;t(n.setWishName(l.name)),t(n.setWishDescription(l.description)),t(n.setWishImg(l.img)),t(n.setWishUrl(l.url)),t(n.setWishListId(l.list_id))}else console.error("\u041D\u0435 \u0443\u0434\u0430\u043B\u043E\u0441\u044C \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044C \u0434\u0430\u043D\u043D\u044B\u0435 \u043F\u043E\u0434\u0430\u0440\u043A\u0430 \u0434\u043B\u044F \u0440\u0435\u0434\u0430\u043A\u0442\u0438\u0440\u043E\u0432\u0430\u043D\u0438\u044F")})});const I=d(t4.selectAll),M=I.map(e=>({value:String(e.id),content:e.name})),m=d(M4),E=d(O4),g=d(G4),x=d(Q4),h=d(V4),O=p.exports.useCallback(e=>{t(n.setWishName(e))},[t]),G=p.exports.useCallback(e=>{t(n.setWishDescription(e))},[t]),Q=p.exports.useCallback(e=>{t(n.setWishImg(e))},[t]),V=p.exports.useCallback(e=>{t(n.setWishUrl(e))},[t]),q=p.exports.useCallback(e=>{t(n.setWishListId(e))},[t]),[N,z]=p.exports.useState({}),D="\u042D\u0442\u043E \u043F\u043E\u043B\u0435 \u043E\u0431\u044F\u0437\u0430\u0442\u0435\u043B\u044C\u043D\u043E",H=()=>{const e={};return m!=null&&m.trim()||(e.name=D),E!=null&&E.trim()||(e.description=D),g!=null&&g.trim()||(e.img=D),h||(e.list=D),z(e),Object.keys(e).length===0},K=async()=>{if(!H()||!c)return;let e={name:m,description:E,img:g,url:x,list_id:h,user_id:c.id};if(o&&a){const l=await t(k({id:a,data:e}));k.fulfilled.match(l)?(console.log("\u041F\u043E\u0434\u0430\u0440\u043E\u043A \u043E\u0431\u043D\u043E\u0432\u043B\u0451\u043D!"),C(y(String(a)))):console.error("\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u0440\u0438 \u043E\u0431\u043D\u043E\u0432\u043B\u0435\u043D\u0438\u0438 \u043F\u043E\u0434\u0430\u0440\u043A\u0430")}else{const l=await t(f(e));f.fulfilled.match(l)?(h&&t(i4({idUser:c.id})),C(y(String(l.payload.id)))):console.error("\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u0440\u0438 \u0441\u043E\u0437\u0434\u0430\u043D\u0438\u0438 \u043F\u043E\u0434\u0430\u0440\u043A\u0430")}};let A;const J=I.length===0;return $?A=r("div",{className:i.wrapper,children:r(g4,{width:390,height:550})}):P?A=r(j,{align:c4.CENTER,title:"\u041F\u0440\u043E\u0438\u0437\u043E\u0448\u043B\u0430 \u043E\u0448\u0438\u0431\u043A\u0430"}):A=_("div",{className:i.wrapper,children:[r(_4,{className:i.wishImg,value:g,onChange:Q}),_("div",{className:i.wrapperInfo,children:[J?r(v,{theme:S.OUTLINE,onClick:()=>C(a4()),children:"\u0421\u043E\u0437\u0434\u0430\u0442\u044C \u043B\u0438\u0441\u0442"}):r(p4,{options:M,label:"\u0412\u044B\u0431\u0435\u0440\u0435\u0442\u0435 \u0441\u043F\u0438\u0441\u043E\u043A",className:i.list,onChange:q,value:h==null?void 0:h.toString()}),_("div",{className:i.part_one,children:[N.name&&r("span",{className:i.error,children:N.name}),r(w,{placeholder:"\u041D\u0430\u0437\u0432\u0430\u043D\u0438\u0435 \u043F\u043E\u0434\u0430\u0440\u043A\u0430",className:i.fields,value:m,onChange:O}),r(w,{placeholder:"\u041E\u043F\u0438\u0441\u0430\u043D\u0438\u0435",className:i.fields,value:E,onChange:G}),r(w,{placeholder:"\u0421\u0441\u044B\u043B\u043A\u0430",className:i.fields,value:x,onChange:V})]}),r(v,{className:i.btnAdd,theme:S.BACKGROUND,onClick:K,children:"\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C"})]})]}),r(T,{reducers:q4,removeAfterUnmount:!0,children:r("div",{className:r4(i.WishDetails,{},[u]),children:r("div",{className:i.glass,children:A})})})}),H4={wishDetails:E4},a0=p.exports.memo(s=>{const{id:u}=o4(),a=Boolean(u);d(m4),console.log(s);const o=a?`\u0420\u0435\u0434\u0430\u043A\u0442\u0438\u0440\u043E\u0432\u0430\u0442\u044C \u0436\u0435\u043B\u0430\u043D\u0438\u0435 \u2014 ${L}`:`\u0421\u043E\u0437\u0434\u0430\u0442\u044C \u043D\u043E\u0432\u043E\u0435 \u0436\u0435\u043B\u0430\u043D\u0438\u0435 \u2014 ${L}`;return _(T,{reducers:H4,removeAfterUnmount:!0,children:[r(f4,{title:o,description:a?"\u0418\u0437\u043C\u0435\u043D\u0438\u0442\u0435 \u0434\u0430\u043D\u043D\u044B\u0435 \u043F\u043E\u0434\u0430\u0440\u043A\u0430, \u0434\u043E\u0431\u0430\u0432\u044C\u0442\u0435 \u0444\u043E\u0442\u043E, \u043E\u043F\u0438\u0441\u0430\u043D\u0438\u0435 \u0438 \u0441\u0441\u044B\u043B\u043A\u0443.":"\u0414\u043E\u0431\u0430\u0432\u044C\u0442\u0435 \u043D\u043E\u0432\u044B\u0439 \u043F\u043E\u0434\u0430\u0440\u043E\u043A \u0432 \u0441\u043F\u0438\u0441\u043E\u043A \u0436\u0435\u043B\u0430\u0435\u043C\u043E\u0433\u043E, \u0447\u0442\u043E\u0431\u044B \u0434\u0440\u0443\u0437\u044C\u044F \u043C\u043E\u0433\u043B\u0438 \u0435\u0433\u043E \u0443\u0432\u0438\u0434\u0435\u0442\u044C \u0438 \u0437\u0430\u0440\u0435\u0437\u0435\u0440\u0432\u0438\u0440\u043E\u0432\u0430\u0442\u044C.",url:`https://vishi.ru/wish/${u||"new"}`,image:"/images/preview-wish.jpg"}),r(n4,{children:_("div",{className:U.wrapper,children:[r(j,{title:a?"\u0420\u0435\u0434\u0430\u043A\u0442\u0438\u0440\u043E\u0432\u0430\u0442\u044C \u0436\u0435\u043B\u0430\u043D\u0438\u0435":"\u0421\u043E\u0437\u0434\u0430\u0442\u044C \u0436\u0435\u043B\u0430\u043D\u0438\u0435",className:U.header,titleTag:"h1"}),r(z4,{id:u,isEdit:a})]})})]})});export{a0 as default};
