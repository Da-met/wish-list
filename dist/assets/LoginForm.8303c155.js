import{p as f,U as N,I as x,y,r as c,u as I,a as g,j as p,d as a,A as C,e as L,B as v,f as O}from"./index.3996ea3a.js";import{I as E}from"./Input.4d1603a8.js";import{T as A,a as S}from"./Text.d7c5cc0a.js";import{D as k}from"./DynamicModuleLoader.a88b5f4e.js";import{S as U}from"./SeoHead.9f3e0582.js";const R="_LoginForm_1uw0g_1",T="_title_1uw0g_25",G="_loginBtn_1uw0g_54",j="_inputs_1uw0g_58",P="_input_1uw0g_58",b="_testImputs_1uw0g_112",$="_error_1uw0g_121",n={LoginForm:R,title:T,loginBtn:G,inputs:j,input:P,testImputs:b,error:$},d=f("login/loginByUsername",async(u,e)=>{const{extra:o,dispatch:i,rejectWithValue:l}=e;try{console.log("[LOGIN] \u041E\u0442\u043F\u0440\u0430\u0432\u043A\u0430 \u043D\u0430 \u0441\u0435\u0440\u0432\u0435\u0440:",u);const r=await o.api.post("/user/login",u);if(console.log("[LOGIN] \u041E\u0442\u043F\u0440\u0430\u0432\u043A\u0430 \u043D\u0430 \u0441\u0435\u0440\u0432\u0435\u0440:",u),!r.data)throw new Error;const{user:t,accessToken:m}=r.data;return localStorage.setItem("token",m),localStorage.setItem(N,JSON.stringify(t)),console.log("[LOGIN] \u0421\u043E\u0445\u0440\u0430\u043D\u0451\u043D accessToken:",m),console.log("[LOGIN] \u0421\u043E\u0445\u0440\u0430\u043D\u0451\u043D user:",t),i(x.setAuthData(t)),t}catch(r){return console.log(r),l("\u041D\u0435\u043A\u043E\u0440\u0440\u0435\u043A\u0442\u043D\u044B\u0435 \u0434\u0430\u043D\u043D\u044B\u0435 3")}}),K={isLoading:!1,username:"",email:"",password:""},D=y({name:"login",initialState:K,reducers:{setUsername:(u,e)=>{u.username=e.payload},setPassword:(u,e)=>{u.password=e.payload},setEmail:(u,e)=>{u.email=e.payload}},extraReducers:u=>{u.addCase(d.pending,e=>{e.error=void 0,e.isLoading=!0}).addCase(d.fulfilled,(e,o)=>{e.isLoading=!1}).addCase(d.rejected,(e,o)=>{e.isLoading=!1,e.error=o.payload})}}),{actions:h}=D,{reducer:M}=D,q=u=>{var e;return((e=u==null?void 0:u.loginForm)==null?void 0:e.username)||""},H=u=>{var e;return((e=u==null?void 0:u.loginForm)==null?void 0:e.email)||""},J=u=>{var e;return((e=u==null?void 0:u.loginForm)==null?void 0:e.password)||""},V=u=>{var e;return(e=u==null?void 0:u.loginForm)==null?void 0:e.error},W=u=>{var e;return((e=u==null?void 0:u.loginForm)==null?void 0:e.isLoading)||!1},Y={loginForm:M},o4=c.exports.memo(({className:u,onSuccess:e})=>{const o=I(),i=g(q),l=g(H),r=g(J),t=g(V),m=g(W),F=c.exports.useCallback(s=>{o(h.setUsername(s))},[o]),_=c.exports.useCallback(s=>{o(h.setPassword(s))},[o]),w=c.exports.useCallback(s=>{o(h.setEmail(s))},[o]),B=c.exports.useCallback(async s=>{s==null||s.preventDefault(),console.log("[LOGIN] \u041A\u043D\u043E\u043F\u043A\u0430 \u043D\u0430\u0436\u0430\u0442\u0430"),(await o(d({username:i,email:l,password:r}))).meta.requestStatus==="fulfilled"&&(console.log("[LOGIN] \u0423\u0441\u043F\u0435\u0448\u043D\u044B\u0439 \u0432\u0445\u043E\u0434"),e())},[e,o,i,l,r]);return p(k,{removeAfterUnmount:!0,reducers:Y,children:[a(U,{title:`\u0412\u0445\u043E\u0434 \u2014 ${C}`,description:`\u0412\u043E\u0439\u0434\u0438\u0442\u0435 \u0432 \u0441\u0432\u043E\u0439 \u0430\u043A\u043A\u0430\u0443\u043D\u0442 ${C}, \u0447\u0442\u043E\u0431\u044B \u0443\u043F\u0440\u0430\u0432\u043B\u044F\u0442\u044C \u0441\u043F\u0438\u0441\u043A\u0430\u043C\u0438 \u0436\u0435\u043B\u0430\u0435\u043C\u044B\u0445 \u043F\u043E\u0434\u0430\u0440\u043A\u043E\u0432, \u043F\u0440\u043E\u0441\u043C\u0430\u0442\u0440\u0438\u0432\u0430\u0442\u044C \u0438\u0434\u0435\u0438 \u0434\u0440\u0443\u0437\u0435\u0439 \u0438 \u0440\u0435\u0437\u0435\u0440\u0432\u0438\u0440\u043E\u0432\u0430\u0442\u044C \u043F\u043E\u0434\u0430\u0440\u043A\u0438.`,url:"https://vishi.ru/wish/",image:"/images/preview-wish.jpg"}),p("div",{className:L(n.LoginForm,{},[u]),children:[a(A,{title:"\u0424\u043E\u0440\u043C\u0430 \u0430\u0432\u0442\u043E\u0440\u0438\u0437\u0430\u0446\u0438\u0438",className:n.title}),t&&a(A,{text:"\u041E\u0448\u0438\u0431\u043A\u0430: \u0412\u0432\u0435\u0434\u0435\u043D\u043D\u044B\u0435 \u0432\u0430\u043C\u0438 \u0434\u0430\u043D\u043D\u044B\u0435 \u043D\u0435\u0432\u0435\u0440\u043D\u044B",theme:S.ERROR,className:n.error}),a("div",{className:L(n.inputs),children:p("div",{className:n.testImputs,children:[a(E,{type:"text",className:n.input,placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0418\u043C\u044F",onChange:F,value:i}),a(E,{type:"text",className:n.input,placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043F\u043E\u0447\u0442\u0443",onChange:w,value:l}),a(E,{type:"text",className:n.input,placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043F\u0430\u0440\u043E\u043B\u044C",onChange:_,value:r})]})}),a(v,{className:n.loginBtn,theme:O.BACKGROUND,onClick:B,disabled:m,children:"\u0432\u043E\u0439\u0442\u0438"})]})]})});export{o4 as default};
