import{p as E,k as q,T as U,x as G,y as H,r as i,u as L,a as g,j as p,e as b,d as o,B as A,f as C,V as K,M as V,A as y,P as Q}from"./index.3996ea3a.js";import{D as F}from"./DynamicModuleLoader.a88b5f4e.js";import{a as k,b as z,c as J}from"./WishSortSelector.3fab6526.js";import{I as X}from"./Input.4d1603a8.js";import{a as Y}from"./CompilationDetails.d65c23dd.js";import{S as Z}from"./SeoHead.9f3e0582.js";import{T as ee}from"./Text.d7c5cc0a.js";import"./Select.45b962fc.js";import"./setWishCompleted.dd161aee.js";import"./Skeleton.6dbd9952.js";import"./dayjs.min.836cc9db.js";import"./AppImage.c08ece6e.js";import"./unreserveWishThunk.4364bddf.js";import"./check.f8f3949b.js";import"./WishListItem.51abdbd5.js";import"./Avatar.b85790fb.js";const se="_WishesPageFilters_v9t20_1",te="_btns_v9t20_12",ae="_btn_v9t20_12",oe="_active_v9t20_37",ie="_pointer_v9t20_42",f={WishesPageFilters:se,btns:te,btn:ae,active:oe,pointer:ie},N=t=>{var e;return((e=t.wishesPage)==null?void 0:e.isLoading)||!1},D=t=>{var e;return((e=t.wishesPage)==null?void 0:e.page)||1},re=t=>{var e;return((e=t.wishesPage)==null?void 0:e.limit)||6},ne=t=>{var e;return(e=t.wishesPage)==null?void 0:e.hasMore},ue=t=>{var e;return(e=t.wishesPage)==null?void 0:e._inited},B=t=>{var e,s;return(s=(e=t.wishesPage)==null?void 0:e.order)!=null?s:"asc"},T=t=>{var e,s;return(s=(e=t.wishesPage)==null?void 0:e.sort)!=null?s:k.CREATED},R=t=>{var e,s;return(s=(e=t.wishesPage)==null?void 0:e.search)!=null?s:""},$=t=>{var e,s;return(s=(e=t.wishesPage)==null?void 0:e.scope)!=null?s:"all"},I=t=>{var e,s;return(s=(e=t.wishesPage)==null?void 0:e.status)!=null?s:"active"},w=E("wishesPage/fetchWishesList",async(t,e)=>{const{extra:s,rejectWithValue:r,getState:a}=e,l=re(a()),u=T(a()),d=B(a()),c=R(a()),m=D(a()),W=q(a()),v=$(a()),x=I(a());try{U({sort:u,order:d});const P=await s.api.get("/wish",{params:{limit:l,page:m,sort:u,order:d,q:c,u:W==null?void 0:W.id,scope:v,status:x}});if(!P.data)throw new Error;return P.data}catch{return r("error")}}),S=G({selectId:t=>t.id}),ce=S.getSelectors(t=>t.wishesPage||S.getInitialState()),le=H({name:"wishesPageSlice",initialState:S.getInitialState({isLoading:!1,error:void 0,ids:[],entities:{},page:1,hasMore:!0,_inited:!1,limit:6,sort:k.CREATED,search:"",order:"asc",scope:"all",status:"active"}),reducers:{setPage:(t,e)=>{t.page=e.payload},setOrder:(t,e)=>{t.order=e.payload},setSort:(t,e)=>{t.sort=e.payload},setSearch:(t,e)=>{t.search=e.payload},setScope:(t,e)=>{t.scope=e.payload},setStatus:(t,e)=>{t.status=e.payload},initState:t=>{t.limit=6,t._inited=!0}},extraReducers:t=>{t.addCase(w.pending,(e,s)=>{e.error=void 0,e.isLoading=!0,s.meta.arg.replace&&S.removeAll(e)}).addCase(w.fulfilled,(e,s)=>{e.isLoading=!1,e.hasMore=s.payload.length>=e.limit,s.meta.arg.replace?S.setAll(e,s.payload):S.addMany(e,s.payload)}).addCase(w.rejected,(e,s)=>{e.isLoading=!1,e.error=s.payload})}}),{reducer:M,actions:n}=le,O=E("wishesPage/fetchNextWishesPage",async(t,e)=>{const{getState:s,dispatch:r}=e,a=ne(s()),l=D(s()),u=N(s());a&&!u&&(r(n.setPage(l+1)),r(w({})))}),he=E("wishesPage/initWishesPage",async(t,e)=>{const{getState:s,dispatch:r}=e;if(!ue(s())){const l=t.get("order"),u=t.get("sort");l&&r(n.setOrder(l)),u&&r(n.setSort(u)),r(n.initState()),r(w({}))}}),ge="_sortWrapper_1qfin_1",pe="_tabs_1qfin_19",de="_btn_1qfin_24",me="_search_1qfin_45",Pe="_search_input_1qfin_55",fe="_svg_1qfin_60",_={sortWrapper:ge,tabs:pe,btn:de,search:me,search_input:Pe,svg:fe};function _e(t,e){const s=i.exports.useRef();return i.exports.useCallback((...r)=>{s.current&&clearTimeout(s.current),s.current=setTimeout(()=>{t(...r)},e)},[t,e])}const Ce=i.exports.memo(t=>{const{className:e}=t,s=L(),r=g(T),a=g(B),l=g(R),u=g($),d=g(I),c=i.exports.useCallback(()=>{s(w({replace:!0}))},[s]),m=_e(c,500),W=i.exports.useCallback(h=>{s(n.setOrder(h)),s(n.setPage(1)),c()},[s,c]),v=i.exports.useCallback(h=>{s(n.setSort(h)),s(n.setPage(1)),c()},[s,c]),x=i.exports.useCallback(h=>{s(n.setSearch(h)),s(n.setPage(1)),m()},[s,m]),P=i.exports.useCallback(h=>{s(n.setScope(h)),s(n.setPage(1)),c()},[s,c]),j=i.exports.useCallback(h=>{s(n.setStatus(h)),s(n.setPage(1)),c()},[s,c]);return p("div",{className:b(_.WishesPageFilters,{},[e]),children:[p("div",{className:_.sortWrapper,children:[o(z,{order:a,sort:r,status:d,onChangeOrder:W,onChangeSort:v,onChangeStatus:j}),p("div",{className:_.btn,children:[o(A,{onClick:()=>P("all"),theme:u==="all"?C.BACKGROUND:C.CLEAR,children:"\u0412\u0441\u0435"}),o(A,{onClick:()=>P("subscriptions"),theme:u==="subscriptions"?C.BACKGROUND:C.CLEAR,children:"\u0414\u0440\u0443\u0437\u044C\u044F"})]})]}),p("div",{className:_.search,children:[p("svg",{className:_.svg,xmlns:"http://www.w3.org/2000/svg",width:"26",height:"26",viewBox:"0 0 24 24",fill:"none",stroke:"#000000",strokeWidth:"1",strokeLinecap:"round",strokeLinejoin:"round",children:[o("circle",{cx:"11",cy:"11",r:"8"}),o("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),o(X,{className:_.search_input,onChange:x,value:l,placeholder:""})]})]})}),Se="_CompilationsPage_1ewyd_1",we={CompilationsPage:Se},We={wishesPage:M},ve=t=>{const e=L(),s=g(N);return i.exports.useCallback(()=>{s||e(O())},[e,s]),o(F,{reducers:We,removeAfterUnmount:!1,children:o(Y,{className:we.CompilationsPage})})},xe=i.exports.memo(ve),be={wishesPage:M},Ae=t=>{const{className:e}=t,s=L(),r=g(ce.selectAll),a=g(N),[l,u]=i.exports.useState(!0),d=i.exports.useCallback(()=>{u(!0)},[]);i.exports.useCallback(()=>{u(!1)},[]);const[c]=K(),m=i.exports.useCallback(()=>{a||s(O())},[s,a]);return V(()=>{s(he(c))}),p(F,{reducers:be,removeAfterUnmount:!1,children:[o(Z,{title:`${y} \u2014 \u0441\u043F\u0438\u0441\u043A\u0438 \u043F\u043E\u0434\u0430\u0440\u043A\u043E\u0432 \u0438 \u0438\u0434\u0435\u0439`,description:`
					\u0421\u043E\u0437\u0434\u0430\u0432\u0430\u0439\u0442\u0435 \u0441\u043F\u0438\u0441\u043A\u0438 \u043F\u043E\u0434\u0430\u0440\u043A\u043E\u0432, \u0431\u0440\u043E\u043D\u0438\u0440\u0443\u0439\u0442\u0435 \u0436\u0435\u043B\u0430\u043D\u0438\u044F \u0434\u0440\u0443\u0437\u0435\u0439 \u0438 \u0434\u0435\u043B\u0438\u0442\u0435\u0441\u044C \u0432\u0434\u043E\u0445\u043D\u043E\u0432\u0435\u043D\u0438\u0435\u043C. 
					${y} \u2014 \u0443\u0434\u043E\u0431\u043D\u044B\u0439 \u0441\u0435\u0440\u0432\u0438\u0441 \u0434\u043B\u044F \u0432\u044B\u0431\u043E\u0440\u0430 \u0438 \u0445\u0440\u0430\u043D\u0435\u043D\u0438\u044F \u043F\u043E\u0434\u0430\u0440\u043A\u043E\u0432.
				`,url:"https://giftflow.ru/",image:"https://giftflow.ru/images/preview-main.jpg"}),o(Q,{onScrollEnd:m,className:b(f.WishesPage,{},[e]),children:p("div",{className:f.pointer,children:[o("div",{className:f.btns,children:o(A,{className:b(f.btn,{},[]),onClick:d,theme:l?C.ACCENT:C.CLEAR,children:o(ee,{title:"\u041B\u0435\u043D\u0442\u0430",className:f.title,titleTag:"h1"})})}),l?p("div",{children:[o(Ce,{className:f.WishesPageFilters}),o(J,{isLoading:a,wishes:r})]}):o(xe,{})]})})]})},Ue=i.exports.memo(Ae);export{Ue as default};
